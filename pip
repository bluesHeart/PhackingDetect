#!/usr/bin/env bash
set -euo pipefail

ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PIP="$ROOT/.venv/bin/pip"

if [[ ! -x "$PIP" ]]; then
  echo "Missing venv pip: $PIP" >&2
  echo "Create the venv first (see ./py). " >&2
  exit 1
fi

export XDG_CACHE_HOME="$ROOT/.cache"
export HF_HOME="$ROOT/.cache/huggingface"
export PIP_CACHE_DIR="$ROOT/.cache/pip"
mkdir -p "$XDG_CACHE_HOME" "$HF_HOME" "$PIP_CACHE_DIR" 2>/dev/null || true

exec "$PIP" "$@"
